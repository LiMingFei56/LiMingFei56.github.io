---
layout: page
permalink: /network-system/http/http-proxy
---

## 代理

### 代理的分类

* 私有代理     - 客户端使用的代理，为了提高网络性能
* 共享代理     - 服务器使用，集中请求，方便管理和提高性能，如高速缓存代理服务器

* 正向代理     - 类似一个跳板机，通过代理访问不可访问的服务器或者提高网络速度
                 访问原网络无法到达的服务器
                 缓存
                 用户认证
                 记录用户访问信息，对外隐藏，保存隐私

* 反向代理     - 客户端无法感知代理的存在，反向代理是服务器的替代物，甚至冒充服务器
                    的服务器名称和ip地址，让客户端直接访问。
                 保证内网安全
                 负载均衡

### 代理的作用

* 儿童过滤器   - 也就是内容过滤器
* 文档访问控制 - 访问权限管理
* 安全防火墙   - 实现统一的安全策略,统一的流量见监控
* Web缓存      - 缓存常用的文档，减少服务器的压力
* 反向代理     - 服务器加速器，服务器的替代物
* 内容路由器   - 根据流量状况以及内容类型来分发请求
* 转码器       - 传送时修改内容格式，如把jpg转成jpeg
* 匿名者       - 主动删除报文身体特性，提供高度的私密性和匿名性

### 代理的部署

* 出口代理 - 防火墙，内容过滤器等
* 访问代理 - 缓存代理，内容路由器
* 反向代理 - 服务器替代物
* 交换代理 - 负载均衡等

### 代理URL不完整的问题
HTTP设计的时候考虑的是客房端直接与服务器通信，所以客户端可以只传相对URL给服务器。

但是代理不行，代理需要完整的URL才能知道请求发送给谁。

代理URL的规则：
* 如果是完整URL，代理就应该使用这个完整URL。
* 如果提供的是部分URL，而且有Host首部，就应该用Host首部来确定原始服务器的名字
    和端口号
* 如果提供的是部分URL，而且没有Host首部：
    - 如果是反向代理，可以用真实服务器的地址和端口号来配置代理
    - 如果流量被拦截了，就使用拦截者提供的地址访问
    - 如果都失败了，返回一条错误报文

### 代理对URL的修改
不同代理对URL的修改有不同的规则，对URL修改要小心，合理使用Via首部，标注传输中会
经过的中间件



